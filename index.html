<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title id="titleWeb">Lì xì năm 2026</title>
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Francois+One&amp;display=swap'>
    <link rel='stylesheet' href='css/sweetalert.css'>
    <link rel='stylesheet' href='css/custom.css'>
    <script type="text/javascript" src="js/Winwheel.min.js"></script>
    <script type="text/javascript" src="js/TweenMax.min.js"></script>
    <script type="text/javascript" src="js/spin-probability.js"></script>
    <script src='js/sweetalert-dev.js'></script>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.5/dist/sweetalert2.all.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.5/dist/sweetalert2.min.css" rel="stylesheet">
    <script src="./config.js"></script>
    <script src="./js/setting.js"></script>
    <link href="favicon.ico" rel="shortcut icon" type="image/x-icon">
    <style>
        .swal2-html-container {
            color: aliceblue;
        }

        html,
        body {
            margin: 0;
            overflow: hidden
        }

        /* input range */

        input[type=range] {
            -webkit-appearance: none;
            background-color: #DB350B;
            margin: 10px 0;
        }

        input[type=range]:focus {
            outline: none;
        }

        input[type=range]::-webkit-slider-runnable-track {
            height: 12px;
            cursor: pointer;
            background: #DB350B;
            border-radius: 17px;
            border: 1px solid #F27B7F;
        }

        input[type=range]::-webkit-slider-thumb {
            border: 2px solid #F27B7F;
            height: 30px;
            width: 39px;
            border-radius: 14px;
            background: #FF5F0F;
            cursor: pointer;
            -webkit-appearance: none;
            margin-top: -10.5px;
        }

        input[type=range]:focus::-webkit-slider-runnable-track {
            background: #DB350B;
        }

        input[type=range]::-moz-range-track {
            height: 12px;
            cursor: pointer;
            animate: 0.2s;
            background: #DB350B;
            border-radius: 17px;
            border: 1px solid #F27B7F;
        }

        input[type=range]::-moz-range-thumb {
            border: 2px solid #F27B7F;
            height: 30px;
            width: 39px;
            border-radius: 14px;
            background: #FF5F0F;
            cursor: pointer;
        }

        input[type=range]::-ms-track {
            height: 12px;
            cursor: pointer;
            animate: 0.2s;
            background: transparent;
            border-color: transparent;
            color: transparent;
        }

        input[type=range]::-ms-fill-lower {
            background: #DB350B;
            border: 1px solid #F27B7F;
            border-radius: 34px;
        }

        input[type=range]::-ms-fill-upper {
            background: #DB350B;
            border: 1px solid #F27B7F;
            border-radius: 34px;
        }

        input[type=range]::-ms-thumb {
            margin-top: 1px;
            height: 30px;
            width: 39px;
            border-radius: 14px;
            background: #FF5F0F;
            cursor: pointer;
        }

        input[type=range]:focus::-ms-fill-lower {
            background: #DB350B;
        }

        input[type=range]:focus::-ms-fill-upper {
            background: #DB350B;
        }

        .topheader {
            padding: 20px;
        }

        .topheader .responsive {
            width: 200px;
            height: 100px;
        }
    </style>
</head>
<div class="pyro">
    <div class="before" style="z-index: 9999"></div>
    <div class="after"></div>
</div>
<div class='falling-leaves'></div>

<body>
    <div class="topheader">
        <img class="responsive" id="myImg" onclick="changeSetting()" style="z-index:99;top:50px;" src="img/hea2.png" />
    </div>

    <div id="caidat">
        <img id="popup" src="img/popup.png" />
        <div class="sotiendalixi" id="sotiendalixi"></div>
        <div class="lichsulixi" id="lichsulixi"></div>
        <div class="buttontatpopup" onClick="tatpopup()"></div>
        <div class="buttonlammoi" id="lammoi" onClick="lammoi()"></div>
        <div class="nenpopup"></div>
    </div>

    <div id="popupnhantien">
        <img id="popuptien" src="img/popupnhantien.png" />
        <div class="sotienpopupnhantien" id="sotienpopupnhantien">
            <img id="xuatsotienpopup" style="width: 100%;"></img>
        </div>
        <div class="lammoipopupnhantien" id="lammoi" onClick="lammoi()"></div>
        <div class="nenpopup"></div>
    </div>

    <div class="vongquay">
        <canvas id="canvas" width="450" height="450" data-responsiveMinWidth="180" data-responsiveScaleHeight="true"
            data-responsiveMargin="50"></canvas>
        <div id="batdauquay" class="nutbatdau"></div>
        <div onClick="startSpin();" class="nutquay"></div>
    </div>

    <img class="responsive2" style="position:fixed;z-index:99;top:0px;right:0px" src="img/hea1.png" />
    <div style="position:fixed;z-index:99;bottom:-50px;left:0;background:url(img/bot1.png) repeat-x bottom left;"></div>
    <img class="responsive3" style="position:fixed;z-index:99;bottom:20px;left:20px" src="img/bot2.png" />
    <div class="nutcaidat" style="position:fixed;bottom:0px;left:20px" onClick="mopopup()"></div>
    <input type="range" id="range" style="position:fixed;bottom:2px;right:20px;z-index: 999" onmousemove="laypower()"
        touchmousemove="laypower()" min="0" step="0.001" max="1" value="0.3">

    <img style="position:fixed;z-index:99;top:2px;left:1px" src="img/banglixi.png" />
    <div id="annhantien" style="display: none;">
        <img class="buttonnhantien" style="position:fixed;z-index:99;top:153px;left:1px;cursor: pointer;"
            src="img/nhantien.png" onclick="nhantien()" />
        <img style="position:fixed;z-index:99;top:183px;left:24px;" src="img/muiten.gif" />
    </div>

    <div style="position:fixed;z-index:999;top:37px;left:20px;text-shadow: 2px 2px 5px #f7ff29;color: #f2f4be;"
        id="xuatluotquay"></div>

    <img style="position:fixed;z-index:999;top:105px;left:9px" id="xuatsotien"></img>

    <audio id="votay">
        <source src="sound/votay.mp3" type="audio/mpeg">
    </audio>
    <audio id="matluot">
        <source src="sound/matluot.mp3" type="audio/mpeg">
    </audio>
    <!-- <audio id="nhac" autoplay="true" loop="true"><source src="sound/nhac.mp3" type="audio/mpeg"></audio> -->
</body>
<script>
    const range = document.getElementById('range');

    range.addEventListener('touchmove', function () {
        laypower();
    })
    var solanquay = 500;
    // Sau khi load trang sẽ yêu cầu nhập mật khẩu

    function mopopup() {
        document.getElementById("caidat").style.display = "block";
    }

    function tatpopup() {
        document.getElementById("caidat").style.display = "none";
    }

    $(".buttontatpopup").hover(
        function () {
            $("#popup").attr("src", 'img/popup2.png');
        },
        function () {
            $("#popup").attr("src", 'img/popup.png');
        }
    );
    $(".buttonlammoi").hover(
        function () {
            $("#popup").attr("src", 'img/popup.png');
        },
        function () {
            $("#popup").attr("src", 'img/popup.png');
        }
    );
    $(".buttonnhantien").hover(
        function () {
            $(".buttonnhantien").attr("src", 'img/nhantienhover.png');
        },
        function () {
            $(".buttonnhantien").attr("src", 'img/nhantien.png');
        }
    );
    $(".lammoipopupnhantien").hover(
        function () {
            $("#popuptien").attr("src", 'img/popupnhantienhover.png');
        },
        function () {
            $("#popuptien").attr("src", 'img/popupnhantien.png');
        }
    );
    let theWheel = new Winwheel({
        'outerRadius': 220, // Bán kính ngoài
        'innerRadius': 0, // Size lỗ trung tâm
        'textFontSize': 24, // Size chữ
        'textOrientation': 'horizontal', // Chữ nằm ngang
        'textAlignment': 'outer', // Căn chỉnh văn bản ra bên ngoài bánh xe.
        'numSegments': 11, // Số ô
        'responsive': true,
        'segments': [
            {
                'fillStyle': '#33CC33',
                'text': '100.000 VNĐ',
                'size': winwheelPercentToDegrees(10),
                'textFontSize': 18,
                'textFillStyle': '#ffffff'
            }, {
                'fillStyle': '#FFFF99',
                'text': '10.000 VNĐ',
                'size': winwheelPercentToDegrees(10),
                'textFontSize': 16,
                'textFillStyle': '#ffffff'
            }, {
                'fillStyle': '#66FFFF',
                'text': '20.000 VNĐ',
                'size': winwheelPercentToDegrees(10),
                'textFontSize': 16,
                'textFillStyle': '#ffffff'
            }, {
                'fillStyle': '#FF9999',
                'text': '50.000 VNĐ',
                'size': winwheelPercentToDegrees(10),
                'textFontSize': 18,
                'textFillStyle': '#ffffff'
            }, {
                'fillStyle': '#FF9900',
                'text': '200.000 VNĐ',
                'size': winwheelPercentToDegrees(10),
                'textFontSize': 18,
                'textFillStyle': '#ffffff'
            }, {
                'fillStyle': '#66FFFF',
                'text': '20.000 VNĐ',
                'size': winwheelPercentToDegrees(10),
                'textFontSize': 18,
                'textFillStyle': '#ffffff'
            }, {
                'fillStyle': '#FFFF99',
                'text': '10.000 VNĐ',
                'size': winwheelPercentToDegrees(10),
                'textFontSize': 16,
                'textFillStyle': '#ffffff'
            }, {
                'fillStyle': '#FF9999',
                'text': '50.000 VNĐ',
                'size': winwheelPercentToDegrees(10),
                'textFontSize': 16,
                'textFillStyle': '#ffffff'
            }, {
                'fillStyle': '#cd201f',
                'text': '500.000 VNĐ',
                'size': winwheelPercentToDegrees(10),
                'textFontSize': 18,
                'textFillStyle': '#ffffff'
            }, {
                'fillStyle': '#000011',
                'text': 'Ô mất lượt',
                'size': winwheelPercentToDegrees(10),
                'textFontSize': 18,
                'textFillStyle': '#ffffff'
            }],
        'animation': // Chỉ định hình động để sử dụng.
        {
            'type': 'spinToStop',
            'duration': 10, // Thời lượng tính bằng giây.
            'spins': 10, // Số vòng quay hoàn chỉnh mặc định.
            'callbackFinished': alertPrize,
            'callbackSound': playSound, // Chức năng gọi khi âm thanh đánh dấu được kích hoạt.
            'soundTrigger': 'pin', // Chỉ định các chân là để kích hoạt âm thanh, tùy chọn khác là 'phân đoạn'.
            'type': 'spinToStop',
            'duration': 10,
            'easing': 'Power3.easeOut',
            'stopAngle': 0,
        },
        'pins': {
            'number': 100, // Số lượng chân. Họ không gian đều xung quanh bánh xe.
            'responsive': true,
            'fillStyle': 'silver',
            'outerRadius': 4,
        }
    });

    // Vars được sử dụng bởi mã trong trang này để thực hiện các điều khiển nguồn.
    let wheelPower = 13;
    let wheelSpinning = false;
    // ---------------------------------------------------------------------
    // Tải âm thanh đánh dấu và chức năng phát được gọi khi pin đi qua con trỏ.
    let audio = new Audio('sound/tick.mp3'); // Tạo đối tượng âm thanh và tải tập tin tick.mp3.

    var dem = 0;
    var demnhantien = 0; // Đếm số lần click vào nút nhận tiền
    var lichsulixi = "";
    var tongtienlixi = 0;
    var tiendalixi;
    document.getElementById("xuatluotquay").innerHTML = solanquay;
    var votay = document.getElementById("votay");
    var matluot = document.getElementById("matluot");

    function playSound() {
        // Dừng và tua lại âm thanh nếu nó đã phát.
        if (!audio.paused)
            audio.pause();
        audio.currentTime = 0;

        // Phát âm thanh.
        if (audio.paused)
            audio.play();
    }

    // -------------------------------------------------------
    // Xử lý thanh range
    // -------------------------------------------------------
    function laypower() {
        const volum = document.getElementById("range").value; // Lấy dữ liệu thanh range
        votay.volume = volum;
        matluot.volume = volum;
        audio.volume = volum;
    }

    function randomAngle() {
        let raties = JSON.parse(localStorage.getItem("raties"));
        if (!raties) {
            localStorage.setItem("raties", JSON.stringify(CONFIG.raties));
            raties = JSON.parse(localStorage.getItem("raties"));
        }
        let arr = [];
        let index = 1;
        for (let k in raties) {
            arr = arr.concat(Array.from({
                length: raties[k]
            }, (_, i) => index));
            index++;
        }
        let randomIndex = Math.floor(Math.random() * 10000000) % arr.length;
        return arr[randomIndex] * 36 - Math.random() * 34 - 1;
    }

    // -------------------------------------------------------
    // Sau khi nhấp vào nút quay
    // -------------------------------------------------------
    function startSpin() {
        const pick = randomAngleByDenomination(theWheel);
        theWheel.animation.stopAngle = pick.stopAngle;

        // Nút quay không nhấp được khi đang chạy
        if (wheelSpinning == false) {
            // Dựa trên mức công suất được chọn, hãy điều chỉnh số vòng quay cho bánh xe, càng nhiều lần
            // để xoay với thời lượng của hình ảnh động thì bánh xe quay càng nhanh.
            theWheel.animation.spins = wheelPower;

            // Tắt nút xoay để không thể nhấp lại trong khi bánh xe đang quay.
            $(".nutbatdau").css("background-image", "url(img/controtat.png) no-repeat");
            // $(".nutbatdau").css("background-size", "120px 120px");

            // Bắt đầu quay bằng cách gọi startAnimation.
            theWheel.startAnimation();

            // Đặt thành true để không thể thay đổi nguồn và bật nút quay lại trong khi
            // hình ảnh động hiện tại. Người dùng sẽ phải thiết lập lại trước khi quay lại.
            wheelSpinning = true;
        }
    }

    // -------------------------------------------------------
    // Sau khi nhấp vào nút làm mới
    // -------------------------------------------------------
    function lammoi() {
        swal.fire({
            title: "Làm mới vòng quay!",
            text: "Làm mới vòng quay sẽ xoá hết các vòng quay còn lại. \nLịch sử và tổng tiền lì xì vẫn giữ nguyên. \nChú ý nếu tải lại trang sẽ làm mất lịch sử và tổng tiền lì xì\nNhập mật khẩu để tiếp tục:",
            type: "input",
            showCancelButton: true, // Có hiển thị nút cancel không(true = có)
            closeOnConfirm: false, // Có thể tắt popup khi nhấp Ok không (true = có)
            showLoaderOnConfirm: true, // Hiển thị loading khi nhấp vào nút Ok
            animation: "slide-from-top", // Như tên của nó, popup sẽ slide from top
            inputPlaceholder: "Nhập mật khẩu..."
        }).then((result) => {
            if (result.isConfirmed) {
                swal.fire("Làm mới thành công!", "Hãy đưa chiếc điện thoại cho người muốn nhận lì xì nào!", "success");

                document.getElementById("popupnhantien").style.display = "none"; // Tắt popup nhận tiền

                theWheel.stopAnimation(false); // Dừng hình động
                theWheel.rotationAngle = 0; // Đặt lại góc bánh xe về 0 độ.
                theWheel.draw(); // Gọi draw để hiển thị các thay đổi cho bánh xe.

                $(".nutbatdau").css("background-image", "url(img/contro.png)"); // Hiển thị lại nút Quay

                document.getElementById("xuatluotquay").innerHTML = solanquay;

                wheelSpinning = false; // Đặt lại thành false thành các nút nguồn và quay có thể được bấm lại.
                document.getElementById("annhantien").style.display = "none"; // Ẩn nút nhận tiền
                document.getElementById("xuatsotien").src = ""; // Xoá ảnh tiền

                dem = 0;
            }
        });
    }

    // -------------------------------------------------------
    // Sau khi vòng quay quay xong
    // -------------------------------------------------------
    function alertPrize(indicatedSegment) {
        dem++;
        tiendalixi = indicatedSegment.text.replace(".000 VNĐ", "");
        if (dem < solanquay) { // Check xem đã hết lượt quay chưa
            // theWheel.rotationAngle = 0; // Đặt lại góc bánh xe về 0 độ.
            theWheel.rotationAngle = theWheel.rotationAngle + 36000;
            theWheel.draw(); // Gọi draw để hiển thị các thay đổi cho bánh xe.
            wheelSpinning = false; // Đặt lại thành false thành các nút nguồn và quay có thể được bấm lại.

            $(".nutbatdau").css("background-image", "url(img/contro.png)"); // Hiển thị lại nút Quay
            document.getElementById("xuatluotquay").innerHTML = solanquay - dem; // Xuất kết quả


            if (indicatedSegment.text == 'Ô mất lượt') { // Nếu quay vào 0k
                matluot.play(); // Bật nhạc fail

                document.getElementById("annhantien").style.display = "none"; // Ẩn nút nhận tiền
                document.getElementById("xuatsotien").src = ""; // Xoá ảnh tiền
                const urlMoney = "img/cn.jpg";
                Swal.fire({
                    title: "<h3 style='color:black'>" + 'Ôi không!' + "</h3>",
                    text: 'Bạn đã nhận được cái nịt!',
                    imageUrl: urlMoney,
                    imageWidth: 400,
                    imageHeight: 200,
                    imageAlt: 'Custom image',
                    background: '#CD3333',
                })

                // swal("Rất tiếc!", "Bạn không nhận được đồng nào\nNhưng bạn còn lại " + (solanquay - dem) + " lần quay, cố gắng lên nào!", "error");
            } else { // Nếu không quay vào 0k
                votay.play(); // Bật nhạc vỗ tay

                document.getElementById("annhantien").style.display = ""; // Hiển thị nút nhận tiền
                document.getElementById("xuatsotien").src = "img/" + indicatedSegment.text.replace(".000 VNĐ", "") + "k.jpg"; // Xuất ảnh tiền
                const urlMoney = "img/" + indicatedSegment.text.replace(".000 VNĐ", "") + "kk.jpg";
                const text = "Bạn nhận được " + indicatedSegment.text;
                Swal.fire({
                    title: "<h3 style='color:black'>" + 'Xin chúc mừng' + "</h3>",
                    text: text,
                    imageUrl: urlMoney,
                    imageWidth: '100%',
                    imageAlt: 'Custom image',
                    background: '#CD3333',
                    //text col
                })
                // swal("Tết ấm no!", "Bạn nhận được " + indicatedSegment.text + "\nBạn còn lại " + (solanquay - dem) + " lần quay\nChú ý: Nếu quay tiếp bạn sẽ mất số tiền trước đó!", "success");
            }
        }
    }

    // -------------------------------------------------------
    // Sau khi nhấp vào nút nhận tiền
    // -------------------------------------------------------
    function nhantien() {
        document.getElementById("annhantien").style.display = "none"; // Ẩn nút nhận tiền
        document.getElementById("popupnhantien").style.display = "block"; // Mở popup
        document.getElementById("xuatsotienpopup").src = "img/" + tiendalixi + "k.jpg";
        demnhantien++;
        tongtienlixi += Number(tiendalixi);
        document.getElementById("sotiendalixi").innerHTML = tongtienlixi + ".000 VNĐ";
        lichsulixi += "Người " + demnhantien + " : " + tiendalixi + ".000 VNĐ<br/>";
        document.getElementById("lichsulixi").innerHTML = lichsulixi;
    }
    swal.fire("Chúc Mừng Năm Mới!", 'success').then((result) => {
        let audio = new Audio('sound/nhac.mp3');
        audio.loop = true;
        audio.play();
    })
    var respon = window.innerWidth > 992, numDes = 4, numMB = 1, leaveDes = 8, leaveMob = 6, numLeavesWind = respon ? leaveDes : leaveMob, windSpeed = respon ? numDes : numMB, LeafScene = function (t) { this.viewport = t, this.world = document.createElement("div"), this.leaves = [], this.options = { numLeaves: numLeavesWind, wind: { magnitude: 1.2, maxSpeed: windSpeed, duration: 100, start: 0, speed: 0 } }, this.width = this.viewport.offsetWidth, this.height = this.viewport.offsetHeight, this.timer = 0, this._resetLeaf = function (t) { t.x = 2 * this.width - Math.random() * this.width * 1.75, t.y = -10, t.z = 200 * Math.random(), t.x > this.width && (t.x = this.width + 10, t.y = Math.random() * this.height / 2), 0 == this.timer && (t.y = Math.random() * this.height), t.rotation.speed = 10 * Math.random(); var e = Math.random(); return e > .5 ? t.rotation.axis = "X" : e > .25 ? (t.rotation.axis = "Y", t.rotation.x = 180 * Math.random() + 90) : (t.rotation.axis = "Z", t.rotation.x = 360 * Math.random() - 180, t.rotation.speed = 3 * Math.random()), t.xSpeedVariation = .8 * Math.random() - .4, t.ySpeed = Math.random() + 1.5, t }, this._updateLeaf = function (t) { var e = this.options.wind.speed(this.timer - this.options.wind.start, t.y) + t.xSpeedVariation; t.x -= e, t.y += t.ySpeed, t.rotation.value += t.rotation.speed; var i = "translateX( " + t.x + "px ) translateY( " + t.y + "px ) translateZ( " + t.z + "px )  rotate" + t.rotation.axis + "( " + t.rotation.value + "deg )"; "X" !== t.rotation.axis && (i += " rotateX(" + t.rotation.x + "deg)"), t.el.style.webkitTransform = i, t.el.style.MozTransform = i, t.el.style.oTransform = i, t.el.style.transform = i, (t.x < -10 || t.y > this.height + 10) && this._resetLeaf(t) }, this._updateWind = function () { if (0 === this.timer || this.timer > this.options.wind.start + this.options.wind.duration) { this.options.wind.magnitude = Math.random() * this.options.wind.maxSpeed, this.options.wind.duration = 50 * this.options.wind.magnitude + (20 * Math.random() - 10), this.options.wind.start = this.timer; var t = this.height; this.options.wind.speed = function (e, i) { var a = this.magnitude / 1.5 * (t - 2 * i / 3) / t; return a * Math.sin(2 * Math.PI / this.duration * e + 3 * Math.PI / 2) + a } } } }; LeafScene.prototype.init = function () { for (var t = 0; t < this.options.numLeaves; t++) { var e = { el: document.createElement("div"), x: 80, y: 80, z: 80, rotation: { axis: "X", value: 200, speed: 100, x: 0 }, xSpeedVariation: 0, ySpeed: 0, path: { type: 1, start: 0 }, image: 1 }; this._resetLeaf(e), this.leaves.push(e), this.world.appendChild(e.el) } this.world.className = "leaf-scene", this.viewport.appendChild(this.world), this.world.style.webkitPerspective = "1440px", this.world.style.MozPerspective = "1440px", this.world.style.oPerspective = "1440px", this.world.style.perspective = "1440px"; var i = this; window.onresize = function (t) { i.width = i.viewport.offsetWidth, i.height = i.viewport.offsetHeight } }, LeafScene.prototype.render = function () { this._updateWind(); for (var t = 0; t < this.leaves.length; t++)this._updateLeaf(this.leaves[t]); this.timer++, requestAnimationFrame(this.render.bind(this)) }; var leafContainer = document.querySelector(".falling-leaves"), leaves = new LeafScene(leafContainer); leaves.init(), leaves.render();
</script>

</html>